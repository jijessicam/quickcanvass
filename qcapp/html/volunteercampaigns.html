{% extends "base.html" %}
{% block content %}
{% load static %}

<script>
$(document).ready(function() {
  $("#search-rooms").click(function(){
  console.log("test room search");
  $.ajax({
      url: "/search/",
      context: document.body,
      "data": {
        "room-query": $("#room-query").val(),
      },
      type: 'POST',
      success: function(res){
        if(res['error'] == 'room search failed'){
          console.log('room search failed');
        }
        else{ // success! 
          console.log("i got something back!!!");
          console.log(res['results']);
          for (var i in res['results']) {
            console.log(res['results'][i]);
          }
          var trHTML = '';
          $.each(res.results, function(i, item) {
            trHTML += '<tr><td><button type="button" class="list-group-item list-group-item-action buttons">' + item[0]['first'] + '</button></td><td><button type="button" class="list-group-item list-group-item-action buttons">' + item[0]['last'] + '</button></td><td><button type="button" class="list-group-item list-group-item-action buttons">' + item[0]['class'] + '</button></td><td><button type="button" class="list-group-item list-group-item-action buttons">' + item[0]['dorm'] + '</button></td><td><button type="button" class="list-group-item list-group-item-action buttons">' + item[0]['college'] + '</button></td><td><button type="button" class="list-group-item list-group-item-action buttons">' + item[0]['major'] + '</button></td></tr>';
          });
          $('#search-results').append(trHTML);
        }
          // window.location = res['url'];
      },
      error: function(){
          console.log("room search error");
      }
  });
})
});
</script>

<container>
  <div class="col-lg-12 center">
        <h2 class="page-header">Canvass It!</h2>
      </div>
<div class="container-fluid text-center">
  <div class="row content">
    <div class="container">
      <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div id="custom-search-input">
                    <div class="input-group col-md-12">
                        <input type="text" class="form-control input-lg" id="room-query" placeholder="Find Closest Rooms..." />
                        <span class="input-group-btn">
                            <button class="btn btn-info btn-lg" id="search-rooms" type="submit">
                                <i class="glyphicon glyphicon-search"></i>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
      </div>
          <p style = "margin-top: 10px">Thank you for helping {{ title }}.</p>
    </div>
</div>


<!-- testing with HTML table for results -->
<div class="col-sm-10 col-sm-offset-1">
  <table id="search-results" border="1">
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Class Year</th>
      <th>Dorm</th>
      <th>College</th>
      <th>Major</th>
    </tr>
  </div>
</div>

<!-- THIS SECTION: LUISA'S ORIGINAL BUTTON CODE -->
<!-- <div class="col-sm-10 col-sm-offset-1">
        <div class="search-results">
            <button type="button" class="list-group-item list-group-item-action buttons">Love letter to Jessica</button>
            <button type="button" class="list-group-item list-group-item-action buttons">Oh Queen of the Squids</button>
            <button type="button" class="list-group-item list-group-item-action buttons">Kill em</button>
            <button type="button" class="list-group-item list-group-item-action buttons">Kill em</button>
            <button type="button" class="list-group-item list-group-item-action buttons">Kill em with kindness</button>
        </div>
</div> -->


</div>
{% endblock %}

